<!DOCTYPE html><html lang="zh"><head>
  <link href="/assets/css/material-icons.css" rel="stylesheet">
  <link href="/assets/css/material-roboto-mono.css" rel="stylesheet">
  <link href="/assets/css/translator.css" rel="stylesheet">
  <meta charset="utf-8">
  <title>用 RxJS 保证事件顺序 - [译] Juristr.com - Angular 资源集锦</title>
  <base href="/">

  <meta name="viewport" content="width=device-width, initial-scale=1">
  <link rel="icon" type="image/x-icon" href="favicon.ico">
<link rel="stylesheet" href="styles.63d874d3414969525bd7.css"><style></style><script charset="utf-8" src="1.76fb5c19f4f53d13a222.js"></script><script charset="utf-8" src="6.351fc6f1f58006ce2a73.js"></script><style>[_nghost-c2]{height:100vh;display:flex;flex-direction:column}.sidenav-container[_ngcontent-c2]{flex:auto}.sidenav[_ngcontent-c2]{width:300px}.mat-toolbar.mat-primary[_ngcontent-c2]{flex:none}.mat-toolbar.mat-primary.header[_ngcontent-c2]{top:0;margin-bottom:8px}img[_ngcontent-c2]{width:183px;margin-right:1rem;vertical-align:middle}[mat-button][_ngcontent-c2]{min-width:auto}[mat-button].active[_ngcontent-c2]{margin-bottom:-2px;border-bottom:2px solid #fff}mat-sidenav-content[_ngcontent-c2]{position:absolute;top:0;bottom:0;left:0;right:0;overflow-y:auto;padding-left:1rem;padding-right:1rem}a.site-title[_ngcontent-c2]{text-decoration:none;color:#fff}a.site-title[_ngcontent-c2]:visited{color:#fff}</style><style>.mat-subheader{display:flex;box-sizing:border-box;padding:16px;align-items:center}.mat-list-base .mat-subheader{margin:0}.mat-list-base{padding-top:8px;display:block;-webkit-tap-highlight-color:transparent}.mat-list-base .mat-subheader{height:48px;line-height:16px}.mat-list-base .mat-subheader:first-child{margin-top:-8px}.mat-list-base .mat-list-item,.mat-list-base .mat-list-option{display:block;height:48px;-webkit-tap-highlight-color:transparent;width:100%;padding:0}.mat-list-base .mat-list-item .mat-list-item-content,.mat-list-base .mat-list-option .mat-list-item-content{display:flex;flex-direction:row;align-items:center;box-sizing:border-box;padding:0 16px;position:relative;height:inherit}.mat-list-base .mat-list-item .mat-list-item-content-reverse,.mat-list-base .mat-list-option .mat-list-item-content-reverse{display:flex;align-items:center;padding:0 16px;flex-direction:row-reverse;justify-content:space-around}.mat-list-base .mat-list-item .mat-list-item-ripple,.mat-list-base .mat-list-option .mat-list-item-ripple{top:0;left:0;right:0;bottom:0;position:absolute;pointer-events:none}.mat-list-base .mat-list-item.mat-list-item-with-avatar,.mat-list-base .mat-list-option.mat-list-item-with-avatar{height:56px}.mat-list-base .mat-list-item.mat-2-line,.mat-list-base .mat-list-option.mat-2-line{height:72px}.mat-list-base .mat-list-item.mat-3-line,.mat-list-base .mat-list-option.mat-3-line{height:88px}.mat-list-base .mat-list-item.mat-multi-line,.mat-list-base .mat-list-option.mat-multi-line{height:auto}.mat-list-base .mat-list-item.mat-multi-line .mat-list-item-content,.mat-list-base .mat-list-option.mat-multi-line .mat-list-item-content{padding-top:16px;padding-bottom:16px}.mat-list-base .mat-list-item .mat-list-text,.mat-list-base .mat-list-option .mat-list-text{display:flex;flex-direction:column;width:100%;box-sizing:border-box;overflow:hidden;padding:0}.mat-list-base .mat-list-item .mat-list-text>*,.mat-list-base .mat-list-option .mat-list-text>*{margin:0;padding:0;font-weight:400;font-size:inherit}.mat-list-base .mat-list-item .mat-list-text:empty,.mat-list-base .mat-list-option .mat-list-text:empty{display:none}.mat-list-base .mat-list-item.mat-list-item-with-avatar .mat-list-item-content .mat-list-text,.mat-list-base .mat-list-item.mat-list-option .mat-list-item-content .mat-list-text,.mat-list-base .mat-list-option.mat-list-item-with-avatar .mat-list-item-content .mat-list-text,.mat-list-base .mat-list-option.mat-list-option .mat-list-item-content .mat-list-text{padding-right:0;padding-left:16px}[dir=rtl] .mat-list-base .mat-list-item.mat-list-item-with-avatar .mat-list-item-content .mat-list-text,[dir=rtl] .mat-list-base .mat-list-item.mat-list-option .mat-list-item-content .mat-list-text,[dir=rtl] .mat-list-base .mat-list-option.mat-list-item-with-avatar .mat-list-item-content .mat-list-text,[dir=rtl] .mat-list-base .mat-list-option.mat-list-option .mat-list-item-content .mat-list-text{padding-right:16px;padding-left:0}.mat-list-base .mat-list-item.mat-list-item-with-avatar .mat-list-item-content-reverse .mat-list-text,.mat-list-base .mat-list-item.mat-list-option .mat-list-item-content-reverse .mat-list-text,.mat-list-base .mat-list-option.mat-list-item-with-avatar .mat-list-item-content-reverse .mat-list-text,.mat-list-base .mat-list-option.mat-list-option .mat-list-item-content-reverse .mat-list-text{padding-left:0;padding-right:16px}[dir=rtl] .mat-list-base .mat-list-item.mat-list-item-with-avatar .mat-list-item-content-reverse .mat-list-text,[dir=rtl] .mat-list-base .mat-list-item.mat-list-option .mat-list-item-content-reverse .mat-list-text,[dir=rtl] .mat-list-base .mat-list-option.mat-list-item-with-avatar .mat-list-item-content-reverse .mat-list-text,[dir=rtl] .mat-list-base .mat-list-option.mat-list-option .mat-list-item-content-reverse .mat-list-text{padding-right:0;padding-left:16px}.mat-list-base .mat-list-item.mat-list-item-with-avatar.mat-list-option .mat-list-item-content .mat-list-text,.mat-list-base .mat-list-item.mat-list-item-with-avatar.mat-list-option .mat-list-item-content-reverse .mat-list-text,.mat-list-base .mat-list-option.mat-list-item-with-avatar.mat-list-option .mat-list-item-content .mat-list-text,.mat-list-base .mat-list-option.mat-list-item-with-avatar.mat-list-option .mat-list-item-content-reverse .mat-list-text{padding-right:16px;padding-left:16px}.mat-list-base .mat-list-item .mat-list-avatar,.mat-list-base .mat-list-option .mat-list-avatar{flex-shrink:0;width:40px;height:40px;border-radius:50%;object-fit:cover}.mat-list-base .mat-list-item .mat-list-avatar~.mat-divider-inset,.mat-list-base .mat-list-option .mat-list-avatar~.mat-divider-inset{margin-left:72px;width:calc(100% - 72px)}[dir=rtl] .mat-list-base .mat-list-item .mat-list-avatar~.mat-divider-inset,[dir=rtl] .mat-list-base .mat-list-option .mat-list-avatar~.mat-divider-inset{margin-left:auto;margin-right:72px}.mat-list-base .mat-list-item .mat-list-icon,.mat-list-base .mat-list-option .mat-list-icon{flex-shrink:0;width:24px;height:24px;font-size:24px;box-sizing:content-box;border-radius:50%;padding:4px}.mat-list-base .mat-list-item .mat-list-icon~.mat-divider-inset,.mat-list-base .mat-list-option .mat-list-icon~.mat-divider-inset{margin-left:64px;width:calc(100% - 64px)}[dir=rtl] .mat-list-base .mat-list-item .mat-list-icon~.mat-divider-inset,[dir=rtl] .mat-list-base .mat-list-option .mat-list-icon~.mat-divider-inset{margin-left:auto;margin-right:64px}.mat-list-base .mat-list-item .mat-divider,.mat-list-base .mat-list-option .mat-divider{position:absolute;bottom:0;left:0;width:100%;margin:0}[dir=rtl] .mat-list-base .mat-list-item .mat-divider,[dir=rtl] .mat-list-base .mat-list-option .mat-divider{margin-left:auto;margin-right:0}.mat-list-base .mat-list-item .mat-divider.mat-divider-inset,.mat-list-base .mat-list-option .mat-divider.mat-divider-inset{position:absolute}.mat-list-base[dense]{padding-top:4px;display:block}.mat-list-base[dense] .mat-subheader{height:40px;line-height:8px}.mat-list-base[dense] .mat-subheader:first-child{margin-top:-4px}.mat-list-base[dense] .mat-list-item,.mat-list-base[dense] .mat-list-option{display:block;height:40px;-webkit-tap-highlight-color:transparent;width:100%;padding:0}.mat-list-base[dense] .mat-list-item .mat-list-item-content,.mat-list-base[dense] .mat-list-option .mat-list-item-content{display:flex;flex-direction:row;align-items:center;box-sizing:border-box;padding:0 16px;position:relative;height:inherit}.mat-list-base[dense] .mat-list-item .mat-list-item-content-reverse,.mat-list-base[dense] .mat-list-option .mat-list-item-content-reverse{display:flex;align-items:center;padding:0 16px;flex-direction:row-reverse;justify-content:space-around}.mat-list-base[dense] .mat-list-item .mat-list-item-ripple,.mat-list-base[dense] .mat-list-option .mat-list-item-ripple{top:0;left:0;right:0;bottom:0;position:absolute;pointer-events:none}.mat-list-base[dense] .mat-list-item.mat-list-item-with-avatar,.mat-list-base[dense] .mat-list-option.mat-list-item-with-avatar{height:48px}.mat-list-base[dense] .mat-list-item.mat-2-line,.mat-list-base[dense] .mat-list-option.mat-2-line{height:60px}.mat-list-base[dense] .mat-list-item.mat-3-line,.mat-list-base[dense] .mat-list-option.mat-3-line{height:76px}.mat-list-base[dense] .mat-list-item.mat-multi-line,.mat-list-base[dense] .mat-list-option.mat-multi-line{height:auto}.mat-list-base[dense] .mat-list-item.mat-multi-line .mat-list-item-content,.mat-list-base[dense] .mat-list-option.mat-multi-line .mat-list-item-content{padding-top:16px;padding-bottom:16px}.mat-list-base[dense] .mat-list-item .mat-list-text,.mat-list-base[dense] .mat-list-option .mat-list-text{display:flex;flex-direction:column;width:100%;box-sizing:border-box;overflow:hidden;padding:0}.mat-list-base[dense] .mat-list-item .mat-list-text>*,.mat-list-base[dense] .mat-list-option .mat-list-text>*{margin:0;padding:0;font-weight:400;font-size:inherit}.mat-list-base[dense] .mat-list-item .mat-list-text:empty,.mat-list-base[dense] .mat-list-option .mat-list-text:empty{display:none}.mat-list-base[dense] .mat-list-item.mat-list-item-with-avatar .mat-list-item-content .mat-list-text,.mat-list-base[dense] .mat-list-item.mat-list-option .mat-list-item-content .mat-list-text,.mat-list-base[dense] .mat-list-option.mat-list-item-with-avatar .mat-list-item-content .mat-list-text,.mat-list-base[dense] .mat-list-option.mat-list-option .mat-list-item-content .mat-list-text{padding-right:0;padding-left:16px}[dir=rtl] .mat-list-base[dense] .mat-list-item.mat-list-item-with-avatar .mat-list-item-content .mat-list-text,[dir=rtl] .mat-list-base[dense] .mat-list-item.mat-list-option .mat-list-item-content .mat-list-text,[dir=rtl] .mat-list-base[dense] .mat-list-option.mat-list-item-with-avatar .mat-list-item-content .mat-list-text,[dir=rtl] .mat-list-base[dense] .mat-list-option.mat-list-option .mat-list-item-content .mat-list-text{padding-right:16px;padding-left:0}.mat-list-base[dense] .mat-list-item.mat-list-item-with-avatar .mat-list-item-content-reverse .mat-list-text,.mat-list-base[dense] .mat-list-item.mat-list-option .mat-list-item-content-reverse .mat-list-text,.mat-list-base[dense] .mat-list-option.mat-list-item-with-avatar .mat-list-item-content-reverse .mat-list-text,.mat-list-base[dense] .mat-list-option.mat-list-option .mat-list-item-content-reverse .mat-list-text{padding-left:0;padding-right:16px}[dir=rtl] .mat-list-base[dense] .mat-list-item.mat-list-item-with-avatar .mat-list-item-content-reverse .mat-list-text,[dir=rtl] .mat-list-base[dense] .mat-list-item.mat-list-option .mat-list-item-content-reverse .mat-list-text,[dir=rtl] .mat-list-base[dense] .mat-list-option.mat-list-item-with-avatar .mat-list-item-content-reverse .mat-list-text,[dir=rtl] .mat-list-base[dense] .mat-list-option.mat-list-option .mat-list-item-content-reverse .mat-list-text{padding-right:0;padding-left:16px}.mat-list-base[dense] .mat-list-item.mat-list-item-with-avatar.mat-list-option .mat-list-item-content .mat-list-text,.mat-list-base[dense] .mat-list-item.mat-list-item-with-avatar.mat-list-option .mat-list-item-content-reverse .mat-list-text,.mat-list-base[dense] .mat-list-option.mat-list-item-with-avatar.mat-list-option .mat-list-item-content .mat-list-text,.mat-list-base[dense] .mat-list-option.mat-list-item-with-avatar.mat-list-option .mat-list-item-content-reverse .mat-list-text{padding-right:16px;padding-left:16px}.mat-list-base[dense] .mat-list-item .mat-list-avatar,.mat-list-base[dense] .mat-list-option .mat-list-avatar{flex-shrink:0;width:36px;height:36px;border-radius:50%;object-fit:cover}.mat-list-base[dense] .mat-list-item .mat-list-avatar~.mat-divider-inset,.mat-list-base[dense] .mat-list-option .mat-list-avatar~.mat-divider-inset{margin-left:68px;width:calc(100% - 68px)}[dir=rtl] .mat-list-base[dense] .mat-list-item .mat-list-avatar~.mat-divider-inset,[dir=rtl] .mat-list-base[dense] .mat-list-option .mat-list-avatar~.mat-divider-inset{margin-left:auto;margin-right:68px}.mat-list-base[dense] .mat-list-item .mat-list-icon,.mat-list-base[dense] .mat-list-option .mat-list-icon{flex-shrink:0;width:20px;height:20px;font-size:20px;box-sizing:content-box;border-radius:50%;padding:4px}.mat-list-base[dense] .mat-list-item .mat-list-icon~.mat-divider-inset,.mat-list-base[dense] .mat-list-option .mat-list-icon~.mat-divider-inset{margin-left:60px;width:calc(100% - 60px)}[dir=rtl] .mat-list-base[dense] .mat-list-item .mat-list-icon~.mat-divider-inset,[dir=rtl] .mat-list-base[dense] .mat-list-option .mat-list-icon~.mat-divider-inset{margin-left:auto;margin-right:60px}.mat-list-base[dense] .mat-list-item .mat-divider,.mat-list-base[dense] .mat-list-option .mat-divider{position:absolute;bottom:0;left:0;width:100%;margin:0}[dir=rtl] .mat-list-base[dense] .mat-list-item .mat-divider,[dir=rtl] .mat-list-base[dense] .mat-list-option .mat-divider{margin-left:auto;margin-right:0}.mat-list-base[dense] .mat-list-item .mat-divider.mat-divider-inset,.mat-list-base[dense] .mat-list-option .mat-divider.mat-divider-inset{position:absolute}.mat-nav-list a{text-decoration:none;color:inherit}.mat-nav-list .mat-list-item{cursor:pointer;outline:0}mat-action-list button{background:0 0;color:inherit;border:none;font:inherit;outline:inherit;-webkit-tap-highlight-color:transparent}mat-action-list button::-moz-focus-inner{border:0}mat-action-list .mat-list-item{cursor:pointer;outline:inherit}.mat-list-option:not(.mat-list-item-disabled){cursor:pointer;outline:0}@media (-ms-high-contrast:active){.mat-selection-list:focus{outline-style:dotted}.mat-list-option:focus,.mat-list-option:hover,.mat-nav-list .mat-list-item:focus,.mat-nav-list .mat-list-item:hover,mat-action-list .mat-list-item:focus,mat-action-list .mat-list-item:hover{outline:dotted 1px}}@media (hover:none){.mat-list-option:not(.mat-list-item-disabled):hover,.mat-nav-list .mat-list-item:not(.mat-list-item-disabled):hover{background:0 0}}</style><style>[_nghost-c4]{display:block}app-nav-node[_ngcontent-c4]{margin-left:1rem}.title[_ngcontent-c4]{flex:auto;white-space:nowrap;overflow:hidden;text-overflow:ellipsis}mat-list-item[_ngcontent-c4]   .title[_ngcontent-c4]{display:inline-block;padding:12px 0}</style><style>@media (-ms-high-contrast:active){.mat-toolbar{outline:solid 1px}}.mat-toolbar-row,.mat-toolbar-single-row{display:flex;box-sizing:border-box;padding:0 16px;width:100%;flex-direction:row;align-items:center;white-space:nowrap}.mat-toolbar-multiple-rows{display:flex;box-sizing:border-box;flex-direction:column;width:100%}.mat-toolbar-multiple-rows{min-height:64px}.mat-toolbar-row,.mat-toolbar-single-row{height:64px}@media (max-width:599px){.mat-toolbar-multiple-rows{min-height:56px}.mat-toolbar-row,.mat-toolbar-single-row{height:56px}}</style><style>svg[_ngcontent-c8]{vertical-align:middle}</style><style>.mat-drawer-container{position:relative;z-index:1;box-sizing:border-box;-webkit-overflow-scrolling:touch;display:block;overflow:hidden}.mat-drawer-container[fullscreen]{top:0;left:0;right:0;bottom:0;position:absolute}.mat-drawer-container[fullscreen].mat-drawer-opened{overflow:hidden}.mat-drawer-container.mat-drawer-container-explicit-backdrop .mat-drawer-side{z-index:3}.mat-drawer-container.ng-animate-disabled .mat-drawer-backdrop,.mat-drawer-container.ng-animate-disabled .mat-drawer-content,.ng-animate-disabled .mat-drawer-container .mat-drawer-backdrop,.ng-animate-disabled .mat-drawer-container .mat-drawer-content{transition:none}.mat-drawer-backdrop{top:0;left:0;right:0;bottom:0;position:absolute;display:block;z-index:3;visibility:hidden}.mat-drawer-backdrop.mat-drawer-shown{visibility:visible}.mat-drawer-transition .mat-drawer-backdrop{transition-duration:.4s;transition-timing-function:cubic-bezier(.25,.8,.25,1);transition-property:background-color,visibility}@media (-ms-high-contrast:active){.mat-drawer-backdrop{opacity:.5}}.mat-drawer-content{position:relative;z-index:1;display:block;height:100%;overflow:auto}.mat-drawer-transition .mat-drawer-content{transition-duration:.4s;transition-timing-function:cubic-bezier(.25,.8,.25,1);transition-property:transform,margin-left,margin-right}.mat-drawer{position:relative;z-index:4;display:block;position:absolute;top:0;bottom:0;z-index:3;outline:0;box-sizing:border-box;overflow-y:auto;transform:translate3d(-100%,0,0)}@media (-ms-high-contrast:active){.mat-drawer,[dir=rtl] .mat-drawer.mat-drawer-end{border-right:solid 1px currentColor}}@media (-ms-high-contrast:active){.mat-drawer.mat-drawer-end,[dir=rtl] .mat-drawer{border-left:solid 1px currentColor;border-right:none}}.mat-drawer.mat-drawer-side{z-index:2}.mat-drawer.mat-drawer-end{right:0;transform:translate3d(100%,0,0)}[dir=rtl] .mat-drawer{transform:translate3d(100%,0,0)}[dir=rtl] .mat-drawer.mat-drawer-end{left:0;right:auto;transform:translate3d(-100%,0,0)}.mat-drawer-inner-container{width:100%;height:100%;overflow:auto;-webkit-overflow-scrolling:touch}.mat-sidenav-fixed{position:fixed}</style><style>.doc-info[_ngcontent-c13]{margin:1rem 0;color:#777}dl[_ngcontent-c13]{display:inline-flex;margin:0 2rem 1rem 0}dl[_ngcontent-c13] > dt[_ngcontent-c13]{flex:none;font-style:normal}dl[_ngcontent-c13] > dd[_ngcontent-c13]{flex:auto;margin-left:0;padding:0}dl[_ngcontent-c13] > dd[_ngcontent-c13] > a[_ngcontent-c13]{margin-right:1rem}</style><style>[_nghost-c14]{display:block}</style><style>.mat-button .mat-button-focus-overlay,.mat-icon-button .mat-button-focus-overlay{opacity:0}.mat-button:hover .mat-button-focus-overlay,.mat-stroked-button:hover .mat-button-focus-overlay{opacity:.04}@media (hover:none){.mat-button:hover .mat-button-focus-overlay,.mat-stroked-button:hover .mat-button-focus-overlay{opacity:0}}.mat-button,.mat-flat-button,.mat-icon-button,.mat-stroked-button{box-sizing:border-box;position:relative;-webkit-user-select:none;-moz-user-select:none;-ms-user-select:none;user-select:none;cursor:pointer;outline:0;border:none;-webkit-tap-highlight-color:transparent;display:inline-block;white-space:nowrap;text-decoration:none;vertical-align:baseline;text-align:center;margin:0;min-width:64px;line-height:36px;padding:0 16px;border-radius:4px;overflow:visible}.mat-button::-moz-focus-inner,.mat-flat-button::-moz-focus-inner,.mat-icon-button::-moz-focus-inner,.mat-stroked-button::-moz-focus-inner{border:0}.mat-button[disabled],.mat-flat-button[disabled],.mat-icon-button[disabled],.mat-stroked-button[disabled]{cursor:default}.mat-button.cdk-keyboard-focused .mat-button-focus-overlay,.mat-button.cdk-program-focused .mat-button-focus-overlay,.mat-flat-button.cdk-keyboard-focused .mat-button-focus-overlay,.mat-flat-button.cdk-program-focused .mat-button-focus-overlay,.mat-icon-button.cdk-keyboard-focused .mat-button-focus-overlay,.mat-icon-button.cdk-program-focused .mat-button-focus-overlay,.mat-stroked-button.cdk-keyboard-focused .mat-button-focus-overlay,.mat-stroked-button.cdk-program-focused .mat-button-focus-overlay{opacity:.12}.mat-button::-moz-focus-inner,.mat-flat-button::-moz-focus-inner,.mat-icon-button::-moz-focus-inner,.mat-stroked-button::-moz-focus-inner{border:0}.mat-raised-button{box-sizing:border-box;position:relative;-webkit-user-select:none;-moz-user-select:none;-ms-user-select:none;user-select:none;cursor:pointer;outline:0;border:none;-webkit-tap-highlight-color:transparent;display:inline-block;white-space:nowrap;text-decoration:none;vertical-align:baseline;text-align:center;margin:0;min-width:64px;line-height:36px;padding:0 16px;border-radius:4px;overflow:visible;transform:translate3d(0,0,0);transition:background .4s cubic-bezier(.25,.8,.25,1),box-shadow 280ms cubic-bezier(.4,0,.2,1)}.mat-raised-button::-moz-focus-inner{border:0}.mat-raised-button[disabled]{cursor:default}.mat-raised-button.cdk-keyboard-focused .mat-button-focus-overlay,.mat-raised-button.cdk-program-focused .mat-button-focus-overlay{opacity:.12}.mat-raised-button::-moz-focus-inner{border:0}._mat-animation-noopable.mat-raised-button{transition:none;animation:none}.mat-stroked-button{border:1px solid currentColor;padding:0 15px;line-height:34px}.mat-stroked-button .mat-button-focus-overlay,.mat-stroked-button .mat-button-ripple.mat-ripple{top:-1px;left:-1px;right:-1px;bottom:-1px}.mat-fab{box-sizing:border-box;position:relative;-webkit-user-select:none;-moz-user-select:none;-ms-user-select:none;user-select:none;cursor:pointer;outline:0;border:none;-webkit-tap-highlight-color:transparent;display:inline-block;white-space:nowrap;text-decoration:none;vertical-align:baseline;text-align:center;margin:0;min-width:64px;line-height:36px;padding:0 16px;border-radius:4px;overflow:visible;transform:translate3d(0,0,0);transition:background .4s cubic-bezier(.25,.8,.25,1),box-shadow 280ms cubic-bezier(.4,0,.2,1);min-width:0;border-radius:50%;width:56px;height:56px;padding:0;flex-shrink:0}.mat-fab::-moz-focus-inner{border:0}.mat-fab[disabled]{cursor:default}.mat-fab.cdk-keyboard-focused .mat-button-focus-overlay,.mat-fab.cdk-program-focused .mat-button-focus-overlay{opacity:.12}.mat-fab::-moz-focus-inner{border:0}._mat-animation-noopable.mat-fab{transition:none;animation:none}.mat-fab .mat-button-wrapper{padding:16px 0;display:inline-block;line-height:24px}.mat-mini-fab{box-sizing:border-box;position:relative;-webkit-user-select:none;-moz-user-select:none;-ms-user-select:none;user-select:none;cursor:pointer;outline:0;border:none;-webkit-tap-highlight-color:transparent;display:inline-block;white-space:nowrap;text-decoration:none;vertical-align:baseline;text-align:center;margin:0;min-width:64px;line-height:36px;padding:0 16px;border-radius:4px;overflow:visible;transform:translate3d(0,0,0);transition:background .4s cubic-bezier(.25,.8,.25,1),box-shadow 280ms cubic-bezier(.4,0,.2,1);min-width:0;border-radius:50%;width:40px;height:40px;padding:0;flex-shrink:0}.mat-mini-fab::-moz-focus-inner{border:0}.mat-mini-fab[disabled]{cursor:default}.mat-mini-fab.cdk-keyboard-focused .mat-button-focus-overlay,.mat-mini-fab.cdk-program-focused .mat-button-focus-overlay{opacity:.12}.mat-mini-fab::-moz-focus-inner{border:0}._mat-animation-noopable.mat-mini-fab{transition:none;animation:none}.mat-mini-fab .mat-button-wrapper{padding:8px 0;display:inline-block;line-height:24px}.mat-icon-button{padding:0;min-width:0;width:40px;height:40px;flex-shrink:0;line-height:40px;border-radius:50%}.mat-icon-button .mat-icon,.mat-icon-button i{line-height:24px}.mat-button-focus-overlay,.mat-button-ripple.mat-ripple{top:0;left:0;right:0;bottom:0;position:absolute;pointer-events:none;border-radius:inherit}.mat-button-focus-overlay{opacity:0;transition:opacity .2s cubic-bezier(.35,0,.25,1),background-color .2s cubic-bezier(.35,0,.25,1)}._mat-animation-noopable .mat-button-focus-overlay{transition:none}@media (-ms-high-contrast:active){.mat-button-focus-overlay{background-color:#fff}}@media (-ms-high-contrast:black-on-white){.mat-button-focus-overlay{background-color:#000}}.mat-button-ripple-round{border-radius:50%;z-index:1}.mat-button .mat-button-wrapper>*,.mat-fab .mat-button-wrapper>*,.mat-flat-button .mat-button-wrapper>*,.mat-icon-button .mat-button-wrapper>*,.mat-mini-fab .mat-button-wrapper>*,.mat-raised-button .mat-button-wrapper>*,.mat-stroked-button .mat-button-wrapper>*{vertical-align:middle}.mat-form-field:not(.mat-form-field-appearance-legacy) .mat-form-field-prefix .mat-icon-button,.mat-form-field:not(.mat-form-field-appearance-legacy) .mat-form-field-suffix .mat-icon-button{display:block;font-size:inherit;width:2.5em;height:2.5em}@media (-ms-high-contrast:active){.mat-button,.mat-fab,.mat-flat-button,.mat-icon-button,.mat-mini-fab,.mat-raised-button{outline:solid 1px}}</style><style>svg[_ngcontent-c10]{vertical-align:middle}</style><style>.mat-icon{background-repeat:no-repeat;display:inline-block;fill:currentColor;height:24px;width:24px}.mat-icon.mat-icon-inline{font-size:inherit;height:inherit;line-height:inherit;width:inherit}[dir=rtl] .mat-icon-rtl-mirror{transform:scale(-1,1)}.mat-form-field:not(.mat-form-field-appearance-legacy) .mat-form-field-prefix .mat-icon,.mat-form-field:not(.mat-form-field-appearance-legacy) .mat-form-field-suffix .mat-icon{display:block}.mat-form-field:not(.mat-form-field-appearance-legacy) .mat-form-field-prefix .mat-icon-button .mat-icon,.mat-form-field:not(.mat-form-field-appearance-legacy) .mat-form-field-suffix .mat-icon-button .mat-icon{margin:auto}</style></head>
<body>
<app-root _nghost-c0="" ng-version="7.2.7"><router-outlet _ngcontent-c0=""></router-outlet><app-article-layout _nghost-c1="" class="ng-star-inserted"><app-layout-nav _ngcontent-c1="" _nghost-c2=""><mat-toolbar _ngcontent-c2="" class="mat-elevation-z6 header mat-toolbar mat-primary mat-toolbar-single-row" color="primary"><!----><a _ngcontent-c2="" routerlink="/" href="/"><app-icon-angular _ngcontent-c2="" _nghost-c8=""><svg _ngcontent-c8="" xml:space="preserve" height="48" id="Layer_1" version="1.1" viewBox="0 0 250 250" width="48" xmlns="http://www.w3.org/2000/svg"><style _ngcontent-c8="" type="text/css"> .st0 { fill: #DD0031; } .st1 { fill: #C3002F; } .st2 { fill: #FFFFFF; }
</style><g _ngcontent-c8=""><polygon _ngcontent-c8="" class="st0" points="125,30 125,30 125,30 31.9,63.2 46.1,186.3 125,230 125,230 125,230 203.9,186.3 218.1,63.2  "></polygon><polygon _ngcontent-c8="" class="st1" points="125,30 125,52.2 125,52.1 125,153.4 125,153.4 125,230 125,230 203.9,186.3 218.1,63.2 125,30  "></polygon><path _ngcontent-c8="" class="st2" d="M125,52.1L66.8,182.6h0h21.7h0l11.7-29.2h49.4l11.7,29.2h0h21.7h0L125,52.1L125,52.1L125,52.1L125,52.1   L125,52.1z M142,135.4H108l17-40.9L142,135.4z"></path></g></svg></app-icon-angular></a><a _ngcontent-c2="" class="site-title" routerlink="/" href="/"><!----><!----><div _ngcontent-c2="" class="ng-star-inserted"><img _ngcontent-c2="" alt="Angular 资源集锦" src="/assets/icons/logo.svg"></div></a><!----><!----><div _ngcontent-c2="" class="flex-spacer ng-star-inserted"></div><a _ngcontent-c2="" aria-label="GitHub 仓库" href="https://github.com/ng-docs/awesome-angular" mat-button="" target="_blank" class="mat-button ng-star-inserted" tabindex="0" aria-disabled="false"><span class="mat-button-wrapper"><app-icon-github _ngcontent-c2="" _nghost-c10=""><svg _ngcontent-c10="" height="26" viewBox="0 0 20 20" width="26" xmlns="http://www.w3.org/2000/svg"><title _ngcontent-c10=""> github-circle-white-transparent</title><path _ngcontent-c10="" d="M10 0C4.477 0 0 4.477 0 10c0 4.42 2.87 8.17 6.84 9.5.5.08.66-.23.66-.5v-1.69c-2.77.6-3.36-1.34-3.36-1.34-.46-1.16-1.11-1.47-1.11-1.47-.91-.62.07-.6.07-.6 1 .07 1.53 1.03 1.53 1.03.87 1.52 2.34 1.07 2.91.83.09-.65.35-1.09.63-1.34-2.22-.25-4.55-1.11-4.55-4.92 0-1.11.38-2 1.03-2.71-.1-.25-.45-1.29.1-2.64 0 0 .84-.27 2.75 1.02.79-.22 1.65-.33 2.5-.33.85 0 1.71.11 2.5.33 1.91-1.29 2.75-1.02 2.75-1.02.55 1.35.2 2.39.1 2.64.65.71 1.03 1.6 1.03 2.71 0 3.82-2.34 4.66-4.57 4.91.36.31.69.92.69 1.85V19c0 .27.16.59.67.5C17.14 18.16 20 14.42 20 10A10 10 0 0 0 10 0z" fill="#FFF" fill-rule="evenodd"></path></svg></app-icon-github></span><div class="mat-button-ripple mat-ripple" matripple=""></div><div class="mat-button-focus-overlay"></div></a></mat-toolbar><mat-sidenav-container _ngcontent-c2="" class="sidenav-container mat-drawer-container mat-sidenav-container"><!----><div class="mat-drawer-backdrop ng-star-inserted"></div><div class="cdk-visually-hidden cdk-focus-trap-anchor" aria-hidden="true"></div><mat-sidenav _ngcontent-c2="" class="sidenav mat-drawer mat-sidenav ng-tns-c12-0 ng-trigger ng-trigger-transform mat-drawer-side ng-star-inserted" tabindex="-1" role="navigation" style="transform: none; visibility: visible;"><div class="mat-drawer-inner-container"><mat-nav-list _ngcontent-c1="" class="mat-nav-list mat-list-base" role="navigation"><app-nav-node _ngcontent-c1="" _nghost-c4=""><!----><!----><!----><a _ngcontent-c4="" class="mat-list-item ng-star-inserted" mat-list-item="" routerlinkactive="active" href="/articles/4fddf607_Awesome_Angular_%E6%AC%A2%E8%BF%8E%E6%82%A8" style=""><div class="mat-list-item-content"><div class="mat-list-item-ripple mat-ripple" mat-ripple=""></div><div class="mat-list-text"></div><div _ngcontent-c4="" class="title" title="Awesome Angular 欢迎您！"><!----> Awesome Angular 欢迎您！ </div></div></a><!----><!----><!----><!----><!----><div _ngcontent-c4="" class="ng-star-inserted" style=""><mat-list-item _ngcontent-c4="" apptoggle="" class="mat-list-item"><div class="mat-list-item-content"><div class="mat-list-item-ripple mat-ripple" mat-ripple=""></div><div class="mat-list-text"></div><a _ngcontent-c4="" class="title" title="雪狼湖" href="/articles/69f9cc1e_%E6%96%87%E9%9B%86%E6%94%B9%E5%90%8D%E4%B8%BA%E4%B8%93%E6%A0%8F">雪狼湖</a><!----><!----><mat-icon _ngcontent-c4="" class="mat-icon notranslate material-icons mat-icon-no-color ng-star-inserted" role="img" aria-hidden="true">chevron_right</mat-icon></div></mat-list-item><div _ngcontent-c4="" hidden=""><app-nav-node _ngcontent-c4="" _nghost-c4=""><!----><!----><!----><a _ngcontent-c4="" class="mat-list-item ng-star-inserted" mat-list-item="" routerlinkactive="active" href="/articles/69f9cc1e_%E6%96%87%E9%9B%86%E6%94%B9%E5%90%8D%E4%B8%BA%E4%B8%93%E6%A0%8F"><div class="mat-list-item-content"><div class="mat-list-item-ripple mat-ripple" mat-ripple=""></div><div class="mat-list-text"></div><div _ngcontent-c4="" class="title" title="作者寄语"><!----><span _ngcontent-c4="" class="ng-star-inserted">0.&nbsp;</span> 作者寄语 </div></div></a><!----><!----><!----><!----><a _ngcontent-c4="" class="mat-list-item ng-star-inserted" mat-list-item="" routerlinkactive="active" href="/articles/3e892ab0_%E5%BE%AE%E5%89%8D%E7%AB%AF%E6%A6%82%E8%BF%B0"><div class="mat-list-item-content"><div class="mat-list-item-ripple mat-ripple" mat-ripple=""></div><div class="mat-list-text"></div><div _ngcontent-c4="" class="title" title="微前端概述"><!----><span _ngcontent-c4="" class="ng-star-inserted">1.&nbsp;</span> 微前端概述 </div></div></a><!----><!----><!----><!----><a _ngcontent-c4="" class="mat-list-item ng-star-inserted" mat-list-item="" routerlinkactive="active" href="/articles/23a34d9e_RxJS_%E5%BF%AB%E9%80%9F%E5%85%A5%E9%97%A8"><div class="mat-list-item-content"><div class="mat-list-item-ripple mat-ripple" mat-ripple=""></div><div class="mat-list-text"></div><div _ngcontent-c4="" class="title" title="RxJS 快速入门"><!----><span _ngcontent-c4="" class="ng-star-inserted">2.&nbsp;</span> RxJS 快速入门 </div></div></a><!----><!----><!----><!----><a _ngcontent-c4="" class="mat-list-item ng-star-inserted" mat-list-item="" routerlinkactive="active" href="/articles/bdde8563_%E6%8A%80%E6%9C%AF%E9%80%89%E5%9E%8B%E6%8C%87%E5%8D%97"><div class="mat-list-item-content"><div class="mat-list-item-ripple mat-ripple" mat-ripple=""></div><div class="mat-list-text"></div><div _ngcontent-c4="" class="title" title="技术选型指南"><!----><span _ngcontent-c4="" class="ng-star-inserted">3.&nbsp;</span> 技术选型指南 </div></div></a><!----><!----><!----><!----><a _ngcontent-c4="" class="mat-list-item ng-star-inserted" mat-list-item="" routerlinkactive="active" href="/articles/37c88f8a_%E5%BC%80%E5%8F%91%E4%BA%BA%E5%91%98%E8%A6%81%E6%8E%8C%E6%8F%A1%E7%9A%84%E5%8D%81%E5%85%AB%E6%9D%A1_Docker_%E7%9F%A5%E8%AF%86"><div class="mat-list-item-content"><div class="mat-list-item-ripple mat-ripple" mat-ripple=""></div><div class="mat-list-text"></div><div _ngcontent-c4="" class="title" title="开发人员要掌握的十八条 Docker 知识"><!----><span _ngcontent-c4="" class="ng-star-inserted">4.&nbsp;</span> 开发人员要掌握的十八条 Docker 知识 </div></div></a><!----><!----><!----><!----><a _ngcontent-c4="" class="mat-list-item ng-star-inserted" mat-list-item="" routerlinkactive="active" href="/articles/f52d12cb_%E5%9F%BA%E4%BA%8E_Docker_%E7%9A%84%E5%90%8C%E6%9E%84%E5%BC%80%E5%8F%91%E7%8E%AF%E5%A2%83"><div class="mat-list-item-content"><div class="mat-list-item-ripple mat-ripple" mat-ripple=""></div><div class="mat-list-text"></div><div _ngcontent-c4="" class="title" title="基于 Docker 的同构开发环境"><!----><span _ngcontent-c4="" class="ng-star-inserted">5.&nbsp;</span> 基于 Docker 的同构开发环境 </div></div></a><!----><!----><!----><!----><a _ngcontent-c4="" class="mat-list-item ng-star-inserted" mat-list-item="" routerlinkactive="active" href="/articles/929165a6_NestJS_%E7%A5%9E%E4%BC%BC_Angular_%E7%9A%84%E5%90%8E%E7%AB%AF%E6%A1%86%E6%9E%B6"><div class="mat-list-item-content"><div class="mat-list-item-ripple mat-ripple" mat-ripple=""></div><div class="mat-list-text"></div><div _ngcontent-c4="" class="title" title="NestJS，神似 Angular 的后端框架"><!----><span _ngcontent-c4="" class="ng-star-inserted">6.&nbsp;</span> NestJS，神似 Angular 的后端框架 </div></div></a><!----><!----><!----><!----><a _ngcontent-c4="" class="mat-list-item ng-star-inserted" mat-list-item="" routerlinkactive="active" href="/articles/88e33d45_%E6%9E%B6%E6%9E%84%E6%9D%82%E8%B0%88_737_MAX8_%E5%90%AF%E7%A4%BA%E5%BD%95"><div class="mat-list-item-content"><div class="mat-list-item-ripple mat-ripple" mat-ripple=""></div><div class="mat-list-text"></div><div _ngcontent-c4="" class="title" title="架构杂谈：737 MAX8 启示录"><!----><span _ngcontent-c4="" class="ng-star-inserted">7.&nbsp;</span> 架构杂谈：737 MAX8 启示录 </div></div></a><!----><!----><!----><!----><a _ngcontent-c4="" class="mat-list-item ng-star-inserted" mat-list-item="" routerlinkactive="active" href="/articles/72147d18_%E5%88%86%E5%BD%A2%E4%B8%8E%E9%80%92%E5%BD%92"><div class="mat-list-item-content"><div class="mat-list-item-ripple mat-ripple" mat-ripple=""></div><div class="mat-list-text"></div><div _ngcontent-c4="" class="title" title="分形与递归"><!----><span _ngcontent-c4="" class="ng-star-inserted">8.&nbsp;</span> 分形与递归 </div></div></a><!----><!----><!----><!----><a _ngcontent-c4="" class="mat-list-item ng-star-inserted" mat-list-item="" routerlinkactive="active" href="/articles/d8aee300_%E6%97%B6%E9%97%B4"><div class="mat-list-item-content"><div class="mat-list-item-ripple mat-ripple" mat-ripple=""></div><div class="mat-list-text"></div><div _ngcontent-c4="" class="title" title="时间"><!----><span _ngcontent-c4="" class="ng-star-inserted">9.&nbsp;</span> 时间 </div></div></a><!----><!----><!----><!----><a _ngcontent-c4="" class="mat-list-item ng-star-inserted" mat-list-item="" routerlinkactive="active" href="/articles/7d57fe25_%E6%A8%A1%E5%9E%8B%E9%A9%B1%E5%8A%A8%E5%BC%80%E5%8F%91"><div class="mat-list-item-content"><div class="mat-list-item-ripple mat-ripple" mat-ripple=""></div><div class="mat-list-text"></div><div _ngcontent-c4="" class="title" title="模型驱动开发"><!----><span _ngcontent-c4="" class="ng-star-inserted">10.&nbsp;</span> 模型驱动开发 </div></div></a><!----><!----><!----><!----><a _ngcontent-c4="" class="mat-list-item ng-star-inserted" mat-list-item="" routerlinkactive="active" href="/articles/0db06427_%E7%BB%99_Java_%E7%A8%8B%E5%BA%8F%E5%91%98%E7%9A%84_Angular_%E6%95%99%E7%A8%8B_%E7%9B%B4%E6%92%AD%E5%A4%A7%E7%BA%B2_"><div class="mat-list-item-content"><div class="mat-list-item-ripple mat-ripple" mat-ripple=""></div><div class="mat-list-text"></div><div _ngcontent-c4="" class="title" title="8. 总结与问答"><!----><span _ngcontent-c4="" class="ng-star-inserted">11.&nbsp;</span> 8. 总结与问答 </div></div></a><!----><!----><!----><!----><a _ngcontent-c4="" class="mat-list-item ng-star-inserted" mat-list-item="" routerlinkactive="active" href="/articles/5710c4ed_Angular_Wiki_%E4%B8%AD%E6%96%87%E8%AF%8D%E6%9D%A1"><div class="mat-list-item-content"><div class="mat-list-item-ripple mat-ripple" mat-ripple=""></div><div class="mat-list-text"></div><div _ngcontent-c4="" class="title" title="undefined"><!----><span _ngcontent-c4="" class="ng-star-inserted">12.&nbsp;</span>  </div></div></a><!----><!----></app-nav-node></div></div><!----><!----><!----><!----><div _ngcontent-c4="" class="ng-star-inserted" style=""><mat-list-item _ngcontent-c4="" apptoggle="" class="mat-list-item"><div class="mat-list-item-content"><div class="mat-list-item-ripple mat-ripple" mat-ripple=""></div><div class="mat-list-text"></div><a _ngcontent-c4="" class="title" title="[译] NgxBlog" href="/articles/22c33ef1_%E6%B7%BB%E5%8A%A0_ngx-blog_%E7%9A%84%E7%AE%80%E4%BB%8B">[译] NgxBlog</a><!----><!----><mat-icon _ngcontent-c4="" class="mat-icon notranslate material-icons mat-icon-no-color ng-star-inserted" role="img" aria-hidden="true">chevron_right</mat-icon></div></mat-list-item><div _ngcontent-c4="" hidden=""><app-nav-node _ngcontent-c4="" _nghost-c4=""><!----><!----><!----><a _ngcontent-c4="" class="mat-list-item ng-star-inserted" mat-list-item="" routerlinkactive="active" href="/articles/22c33ef1_%E6%B7%BB%E5%8A%A0_ngx-blog_%E7%9A%84%E7%AE%80%E4%BB%8B"><div class="mat-list-item-content"><div class="mat-list-item-ripple mat-ripple" mat-ripple=""></div><div class="mat-list-text"></div><div _ngcontent-c4="" class="title" title="专栏简介"><!----><span _ngcontent-c4="" class="ng-star-inserted">0.&nbsp;</span> 专栏简介 </div></div></a><!----><!----><!----><!----><a _ngcontent-c4="" class="mat-list-item ng-star-inserted" mat-list-item="" routerlinkactive="active" href="/articles/900f8f1a_Useful__code_extentions_for_Angular_developers"><div class="mat-list-item-content"><div class="mat-list-item-ripple mat-ripple" mat-ripple=""></div><div class="mat-list-text"></div><div _ngcontent-c4="" class="title" title="对 Angular 开发者有用的 @code 扩展"><!----><span _ngcontent-c4="" class="ng-star-inserted">1.&nbsp;</span> 对 Angular 开发者有用的 @code 扩展 </div></div></a><!----><!----><!----><!----><a _ngcontent-c4="" class="mat-list-item ng-star-inserted" mat-list-item="" routerlinkactive="active" href="/articles/833b98b3_Dont_get_lost_in_structure"><div class="mat-list-item-content"><div class="mat-list-item-ripple mat-ripple" mat-ripple=""></div><div class="mat-list-text"></div><div _ngcontent-c4="" class="title" title="不要为项目结构发愁"><!----><span _ngcontent-c4="" class="ng-star-inserted">2.&nbsp;</span> 不要为项目结构发愁 </div></div></a><!----><!----><!----><!----><a _ngcontent-c4="" class="mat-list-item ng-star-inserted" mat-list-item="" routerlinkactive="active" href="/articles/b56b195b_Translate__i18n__your_Angular_Apps_with__ngx-translate_core"><div class="mat-list-item-content"><div class="mat-list-item-ripple mat-ripple" mat-ripple=""></div><div class="mat-list-text"></div><div _ngcontent-c4="" class="title" title="使用 @ngx-translate/core 翻译（i18n）你的 Angular 应用"><!----><span _ngcontent-c4="" class="ng-star-inserted">3.&nbsp;</span> 使用 @ngx-translate/core 翻译（i18n）你的 Angular 应用 </div></div></a><!----><!----></app-nav-node></div></div><!----><!----><!----><!----><div _ngcontent-c4="" class="ng-star-inserted" style=""><mat-list-item _ngcontent-c4="" apptoggle="" class="mat-list-item active"><div class="mat-list-item-content"><div class="mat-list-item-ripple mat-ripple" mat-ripple=""></div><div class="mat-list-text"></div><a _ngcontent-c4="" class="title" title="[译] Juristr.com" href="/articles/c1ea1169_Juristr_%E5%8F%8A%E5%85%B6%E5%8D%9A%E5%AE%A2%E7%9A%84%E7%AE%80%E4%BB%8B">[译] Juristr.com</a><!----><mat-icon _ngcontent-c4="" class="mat-icon notranslate material-icons mat-icon-no-color ng-star-inserted" role="img" aria-hidden="true">expand_more</mat-icon><!----></div></mat-list-item><div _ngcontent-c4=""><app-nav-node _ngcontent-c4="" _nghost-c4=""><!----><!----><!----><a _ngcontent-c4="" class="mat-list-item ng-star-inserted" mat-list-item="" routerlinkactive="active" href="/articles/c1ea1169_Juristr_%E5%8F%8A%E5%85%B6%E5%8D%9A%E5%AE%A2%E7%9A%84%E7%AE%80%E4%BB%8B"><div class="mat-list-item-content"><div class="mat-list-item-ripple mat-ripple" mat-ripple=""></div><div class="mat-list-text"></div><div _ngcontent-c4="" class="title" title="专栏简介"><!----><span _ngcontent-c4="" class="ng-star-inserted">0.&nbsp;</span> 专栏简介 </div></div></a><!----><!----><!----><!----><a _ngcontent-c4="" class="mat-list-item ng-star-inserted" mat-list-item="" routerlinkactive="active" href="/articles/c26e6a87_RxJS_finalize_operator_to_execute_logic_on_Observable_termination"><div class="mat-list-item-content"><div class="mat-list-item-ripple mat-ripple" mat-ripple=""></div><div class="mat-list-text"></div><div _ngcontent-c4="" class="title" title="用 RxJS 的 finalize 操作符在 Observable 终止时执行逻辑"><!----><span _ngcontent-c4="" class="ng-star-inserted">1.&nbsp;</span> 用 RxJS 的 finalize 操作符在 Observable 终止时执行逻辑 </div></div></a><!----><!----><!----><!----><a _ngcontent-c4="" class="mat-list-item ng-star-inserted active" mat-list-item="" routerlinkactive="active" href="/articles/032d55b5_Guarantee_Event_Order_with_RxJS"><div class="mat-list-item-content"><div class="mat-list-item-ripple mat-ripple" mat-ripple=""></div><div class="mat-list-text"></div><div _ngcontent-c4="" class="title" title="用 RxJS 保证事件顺序"><!----><span _ngcontent-c4="" class="ng-star-inserted">2.&nbsp;</span> 用 RxJS 保证事件顺序 </div></div></a><!----><!----></app-nav-node></div></div><!----><!----><!----><!----><div _ngcontent-c4="" class="ng-star-inserted" style=""><mat-list-item _ngcontent-c4="" apptoggle="" class="mat-list-item"><div class="mat-list-item-content"><div class="mat-list-item-ripple mat-ripple" mat-ripple=""></div><div class="mat-list-text"></div><a _ngcontent-c4="" class="title" title="[译] Shai Reznik" href="/articles/706e2b30_Shai_Reznik_%E4%B8%93%E6%A0%8F">[译] Shai Reznik</a><!----><!----><mat-icon _ngcontent-c4="" class="mat-icon notranslate material-icons mat-icon-no-color ng-star-inserted" role="img" aria-hidden="true">chevron_right</mat-icon></div></mat-list-item><div _ngcontent-c4="" hidden=""><app-nav-node _ngcontent-c4="" _nghost-c4=""><!----><!----><!----><a _ngcontent-c4="" class="mat-list-item ng-star-inserted" mat-list-item="" routerlinkactive="active" href="/articles/706e2b30_Shai_Reznik_%E4%B8%93%E6%A0%8F"><div class="mat-list-item-content"><div class="mat-list-item-ripple mat-ripple" mat-ripple=""></div><div class="mat-list-text"></div><div _ngcontent-c4="" class="title" title="专栏简介"><!----><span _ngcontent-c4="" class="ng-star-inserted">0.&nbsp;</span> 专栏简介 </div></div></a><!----><!----><!----><!----><a _ngcontent-c4="" class="mat-list-item ng-star-inserted" mat-list-item="" routerlinkactive="active" href="/articles/5802651d_Angular_Routing___A_Better_Pattern_For_Large_Scale_Apps"><div class="mat-list-item-content"><div class="mat-list-item-ripple mat-ripple" mat-ripple=""></div><div class="mat-list-text"></div><div _ngcontent-c4="" class="title" title="Angular Routing - 大规模应用中更好的模式"><!----><span _ngcontent-c4="" class="ng-star-inserted">1.&nbsp;</span> Angular Routing - 大规模应用中更好的模式 </div></div></a><!----><!----></app-nav-node></div></div><!----></app-nav-node></mat-nav-list></div></mat-sidenav><div class="cdk-visually-hidden cdk-focus-trap-anchor" aria-hidden="true"></div><mat-sidenav-content _ngcontent-c2="" apppartialscroller="" class="mat-drawer-content mat-sidenav-content" style="margin-left: 300px;"><router-outlet _ngcontent-c2=""></router-outlet><app-article-show _nghost-c13="" class="ng-star-inserted"><div _ngcontent-c13="" class="doc-info"><!----><dl _ngcontent-c13="" class="ng-star-inserted"><dt _ngcontent-c13="">作者：</dt><dd _ngcontent-c13=""><a _ngcontent-c13="" href="/authors/Juri%20Strumpflohner">Juri Strumpflohner</a></dd></dl><!----><dl _ngcontent-c13="" class="ng-star-inserted"><dt _ngcontent-c13="">原文：</dt><dd _ngcontent-c13=""><a _ngcontent-c13="" target="_blank" href="https://juristr.com/blog/2019/01/Guarantee-Event-Order-with-RxJS/">点此查看</a></dd></dl><dl _ngcontent-c13=""><dt _ngcontent-c13=""> 译者： </dt><dd _ngcontent-c13=""><a _ngcontent-c13="" href="/authors/%E6%B1%AA%E5%BF%97%E6%88%90">汪志成</a></dd></dl><!----><dl _ngcontent-c13=""><dt _ngcontent-c13="">发表：</dt><dd _ngcontent-c13="">2019年3月8日</dd></dl><!----><dl _ngcontent-c13="" class="ng-star-inserted"><dt _ngcontent-c13="">修改：</dt><dd _ngcontent-c13="">2019年3月10日</dd></dl><br _ngcontent-c13=""><!----><dl _ngcontent-c13="" class="ng-star-inserted"><dt _ngcontent-c13="">收录：</dt><dd _ngcontent-c13=""><a _ngcontent-c13="" href="/articles/c1ea1169_Juristr_%E5%8F%8A%E5%85%B6%E5%8D%9A%E5%AE%A2%E7%9A%84%E7%AE%80%E4%BB%8B">[译] Juristr.com</a></dd></dl></div><app-markdown-viewer _ngcontent-c13="" _nghost-c14=""><div _ngcontent-c14=""><h1 id="guarantee-event-order-with-rxjs" translation-result="on">用 RxJS 保证事件顺序</h1><h1 translation-origin="off">Guarantee Event Order with RxJS</h1>

<blockquote>
<p translation-result="on">使用 concatMap 来保证事件的排序</p><p translation-origin="off">use concatMap to guarantee ordering of events</p>

</blockquote>
<p translation-result="on">当你创建动态界面时，经常要处理异步。它们一般是由某些用户交互触发的。当你需要保证某些操作按顺序执行时，事情往往会变得很棘手。由于它们是异步的，我们可能无法知道哪一个会先返回。让我们来看看 RxJS 在这种情况下要怎样提供帮助。</p><p translation-origin="off">When you create dynamic UIs, you have to deal with async stuff a lot. Most often they are triggered by some user interaction. Things usually get tricky when you need to guarantee certain operations are executed in order. Since they are async we might not know which one returns first. Let's see how RxJS can help a lot here.</p>

<p translation-result="on">为了说明<strong>这个问题</strong>，我创建了一个示范用例。它简化过，但也代表了一个潜在的真实用例。</p><p translation-origin="off">In order to illustrate <strong>the problem</strong> I created an example use case, simplified of course, but still it represents a potential real world use case.</p>

<p translation-result="on"><strong>目录</strong></p><p translation-origin="off"><strong>Table of contents</strong></p>

<ul>
<li><p translation-result="on"><a href="#tl-dr-here-s-the-corresponding-egghead-lesson">太长不读版：这是相应的 Egghead 课程</a></p><p translation-origin="off"><a href="#tl-dr-here-s-the-corresponding-egghead-lesson">TL;DR: Here’s the corresponding Egghead lesson</a></p>

</li>
</ul>
<ul>
<li><p translation-result="on"><a href="#the-problem">问题</a></p><p translation-origin="off"><a href="#the-problem">The Problem</a></p>

</li>
</ul>
<ul>
<li><p translation-result="on"><a href="#we-need-to-guarantee-ordering">我们需要保证顺序</a></p><p translation-origin="off"><a href="#we-need-to-guarantee-ordering">We need to guarantee ordering</a></p>

</li>
</ul>
<ul>
<li><p translation-result="on"><a href="#a-short-note-on-wrapping-settimeout-as-observable">把 <code>setTimeout</code> 包装成 Observable 的简短说明</a></p><p translation-origin="off"><a href="#a-short-note-on-wrapping-settimeout-as-observable">A short note on wrapping <code>setTimeout</code> as Observable</a></p>

</li>
<li><p translation-result="on"><a href="#the-entire-concatmap-example">完整的 <code>concatMap</code> 例子</a></p><p translation-origin="off"><a href="#the-entire-concatmap-example">The entire <code>concatMap</code> example</a></p>

</li>
</ul>
<ul>
<li><p translation-result="on"><a href="#optimizing-with-switchmap">用 <code>switchMap</code> 进行优化</a></p><p translation-origin="off"><a href="#optimizing-with-switchmap">Optimizing with <code>switchMap</code></a></p>

</li>
</ul>
<ul>
<li><p translation-result="on"><a href="#switchmap---potential-race-conditions"><code>switchMap</code> - 潜在的竞态条件</a></p><p translation-origin="off"><a href="#switchmap---potential-race-conditions"><code>switchMap</code> - potential race conditions</a></p>

</li>
</ul>
<ul>
<li><p translation-result="on"><a href="#conclusion">结论</a></p><p translation-origin="off"><a href="#conclusion">Conclusion</a></p>

</li>
</ul>
<p translation-result="on">我们大致会有如下用户界面：</p><p translation-origin="off">We basically have the following user interface:</p>

<p><img src="/assets/content/articles/juri-strumpflohner/./gurantee-event-order-with-rxjs_images/rxjs-order-guarantee.png" alt=""></p>
<p translation-result="on">当用户<strong>选中</strong>某个选项时，就会发出一个 http 请求来获取一些值，一旦请求返回，就会把响应添加到下面的可视化列表中。</p><p translation-origin="off">When the user <strong>checks</strong> some option, an http request is made to retrieve some value and once the request returns, the response is added to a list visualized below.</p>

<blockquote>
<p translation-result="on">为了简单起见，在这个伪造的例子中，我仅仅用 <code>setTimeout(..)</code> 来模拟异步请求。</p><p translation-origin="off">For the sake of simplicity, in this fake example I simply use a <code>setTimeout(..)</code> to simulate the asyncronous request.</p>

</blockquote>
<p translation-result="on">当用户再次<strong>取消选中</strong>该选项时，相应的值也会从下面的列表中删除（但不需要任何异步请求）。</p><p translation-origin="off">When the user again <strong>deselects</strong> the option, the corresponding value is removed from the list below (without any async request).</p>

<h2 id="tldr-heres-the-corresponding-egghead-lesson" translation-result="on">太长不读版：这里是相应的 Egghead 课程</h2><h2 translation-origin="off">TL;DR: Here’s the corresponding Egghead lesson</h2>

<p translation-result="on"><a href="https://egghead.io/lessons/angular-guarantee-ordering-of-events-with-rxjs" target="_blank">在 Egghead.io 上查看</a></p><p translation-origin="off"><a href="https://egghead.io/lessons/angular-guarantee-ordering-of-events-with-rxjs" target="_blank">View on Egghead.io</a></p>

<h2 id="the-problem" translation-result="on">问题</h2><h2 translation-origin="off">The Problem</h2>

<p translation-result="on">选中某个选项时发出的异步请求当然要过一段时间才能返回。那么在用户双击时会发生什么？</p><p translation-origin="off">The async request made when checking an option might take a while before coming back of course. That said, what happens when the user double-clicks 😕?</p>

<p translation-result="on"><a href="https://stackblitz.com/edit/blog-guarantee-order-wrong" target="_blank">亲自试试</a>吧。</p><p translation-origin="off">Well, try by yourself:</p>

<p translation-result="on">如你所见，我们可能会得到不一致的状态。例如，当快速双击“Option 1”时，我们就会选中该选项，然后再次取消选中，接下来的异步回调仍然会把该选项添加到列表中。</p><p translation-origin="off">As you can see, we might get an inconsistent state. When - for instance - quickly double-clicking on “Option 1” we get the option selected &amp; then unselected again, but the async call coming later still adds the option to the list.</p>

<p translation-result="on">通过审视复选框选中事件中所做的事就可以看清问题之所在：</p><p translation-origin="off">The issue is quite clear by looking at what happens in the checkbox selection event:</p>

<pre><code class="language-typescript">...
<span class="hljs-keyword">if</span>(<span class="hljs-keyword">data</span>.checkboxEvent.checked) {
    <span class="hljs-comment">// simulate async call</span>
    setTimeout(() =&gt; {
      <span class="hljs-comment">// add the record</span>
      <span class="hljs-keyword">this</span>.records.push(<span class="hljs-keyword">data</span>.option)
    }, <span class="hljs-number">1500</span>)
} <span class="hljs-keyword">else</span> {
    <span class="hljs-comment">// remove the record given by the id (if present)</span>
    <span class="hljs-keyword">this</span>.records = <span class="hljs-keyword">this</span>.records.filter(x =&gt; x.value !== id );
}</code></pre>
<p translation-result="on">由于较慢的异步调用会在稍后返回，因此它仍会添加记录，而不管我们是否在此期间取消选中了它。</p><p translation-origin="off">The slower async call comes back later, thus it adds the record, regardless of whether we unchecked it again in the meantime.</p>

<h2 id="we-need-to-guarantee-ordering" translation-result="on">我们需要保证顺序</h2><h2 translation-origin="off">We need to guarantee ordering</h2>

<p translation-result="on">我们必须保证此事件的顺序。因此，当双击时，我们需要确保只有在潜在的异步调用返回后才能执行“取消选中”的逻辑。这很棘手。当异步调用返回时，你可以检查相应的选项是否仍在选中状态，并且只有在这种情况下才执行该逻辑。或者，你也可以保存一些标志，当正在执行异步逻辑期间阻塞其它逻辑……<br>这无法令人满意，只是取巧罢了……而且，这还仅仅是个简单的小例子。</p><p translation-origin="off">We somehow need to guarantee ordering of the events. Thus, when double-clicking, we need to make sure that the logic for “unchecking” is executed only after a potential async call returns. Implementing this can be quite tricky. You could check whether the corresponding option is still checked when the async call returns and only in that case execute the logic. Alternatively, you could hold some flag, blocking other logic to be executed while an async call is running…<br>Not really satisfying and hacky.., and again, this is just a small simple fake example.</p>

<p translation-result="on">好吧，是主角登场的时候了。如果你懂 RxJS，那么这很容易实现：使用 <code>concatMap</code> 操作符。</p><p translation-origin="off">Well, turns out that if you know RxJS, this is quite easily achievable: using the <code>concatMap</code> operator.</p>

<blockquote>
<p translation-result="on"><code>concatMap</code> - 按顺序将值映射为内部的 Observable，并且按顺序订阅这个内部 Observable、并且按顺序发送值。</p><p translation-origin="off"><code>concatMap</code> - Map values to inner observable, subscribe and emit in order.</p>

</blockquote>
<p translation-result="on"><strong>其思路是把选中/取消选中的事件通过管道发送</strong>到一个 RxJS Subject 中，然后依次处理它们。</p><p translation-origin="off"><strong>The idea is to pipe the events</strong> from the checking/unchecking into a RxJS subject and then process them one after the other.</p>

<pre><code class="language-typescript"><span class="hljs-keyword">private</span> selectionSubject = <span class="hljs-keyword">new</span> Subject&lt;SelectionEvent&gt;();
...
<span class="hljs-keyword">this</span>.selectionEvent
  .pipe(
    concatMap(<span class="hljs-function"><span class="hljs-params">data</span> =&gt;</span> {
      ...
    })
  ).subscribe(<span class="hljs-function"><span class="hljs-params">action</span> =&gt;</span> {
    ...
  })</code></pre>
<p translation-result="on">我们会在 <code>concatMap</code> 中实现处理这些动作的逻辑。</p><p translation-origin="off">Inside the <code>concatMap</code> we implement the logic of handling the actions.</p>

<pre><code class="language-typescript"><span class="hljs-params">...</span>
.concatMap(<span class="hljs-built_in">data</span> =&gt; {
  const id = <span class="hljs-built_in">data</span>.option.value;

  <span class="hljs-keyword">if</span> (<span class="hljs-built_in">data</span>.checkboxEvent.checked) {
    <span class="hljs-comment">/*
      do the async call and then return
      an action object like
      {
        type: 'ADD',
        data: ...
      }
    */</span>
  } <span class="hljs-keyword">else</span> {
    <span class="hljs-comment">/*
      Nothing to call, just remove
      the corresponding record, thus return
      a "remove" action
      {
        type: 'REMOVE',
        data: id
      }
    */</span>
  }
})
<span class="hljs-params">...</span></code></pre>
<p translation-result="on">当我们收到一个选中事件时，就会执行这个异步调用；如果没收到就触发一个从列表中删除该项的动作。我们总是要返回一个 Observable。 <code>concatMap</code> 会订阅那个“内部 Observable”，只有当前一个“完成（complete）”时才会继续执行下一个“内部 Observable”，这样就<strong>保证了事件的顺序</strong> 。</p><p translation-origin="off">When we receive a checked event, then we execute the async call, otherwise we trigger an action for removing the item from the list. We need to always return an Observable for that. <code>concatMap</code> subscribes to that “inner Observable” and proceeds with the next only once the previous one “completes”, thus <strong>guaranteeing ordering of our events</strong>.</p>

<blockquote>
<p translation-result="on">一旦 Observable “完事”了就会 <code>complete</code>。这里的 <code>complete</code> 就像是 <code>Promise</code> 的 <code>resolve(..)</code>。</p><p translation-origin="off">An Observable “completes” once it is done. It is similar to the <code>resolve(..)</code> of a <code>Promise</code>.</p>

</blockquote>
<h4 id="a-short-note-on-wrapping-settimeout-as-observable" translation-result="on">对于把 <code>setTimeout</code> 包装成 Observable 的简短说明</h4><h4 translation-origin="off">A short note on wrapping <code>setTimeout</code> as Observable</h4>

<p translation-result="on">还记得如何用 <code>setTimeout</code> 模拟异步调用吧。好，我们现在要把它包装进一个 Observable 中。有两种方法可以做到这一点。</p><p translation-origin="off">You remember we use <code>setTimeout</code> to simulate an async call. Well, we need to wrap it into an Observable. There are two ways of doing it.</p>

<p translation-result="on">*<em>使用 <code>timer</code> *</em> Observable - 我们可以简单地使用 RxJS 提供的现有 <code>timer(..)</code> 函数：</p><p translation-origin="off"><strong>Using the <code>timer</code> observable</strong> - we can simply use the existing <code>timer(..)</code> which the RxJS exposes for us:</p>

<pre><code class="language-typescript">timer(<span class="hljs-number">1500</span>)
  .pipe(
    <span class="hljs-built_in">map</span>(_ =&gt; ({
      <span class="hljs-keyword">type</span>: <span class="hljs-string">'ADD'</span>,
      <span class="hljs-built_in">data</span>: <span class="hljs-params">...</span>
    }))
  )</code></pre>
<p translation-result="on">另外，我们还<strong>可以用 <code>Observable.create(...)</code> 自行创建一个 Observable</strong> ：</p><p translation-origin="off">Alternatively, we <strong>can create an Observable by ourselves</strong> with <code>Observable.create(...)</code>:</p>

<pre><code class="language-typescript"><span class="hljs-keyword">return</span> Observable.create(<span class="hljs-function">(<span class="hljs-params">observer</span>) =&gt;</span> {
  <span class="hljs-keyword">const</span> timeout = setTimeout(<span class="hljs-function"><span class="hljs-params">()</span> =&gt;</span> {
    <span class="hljs-built_in">console</span>.log(<span class="hljs-string">'Returning data'</span>);
    observer.next({
      <span class="hljs-keyword">type</span>: <span class="hljs-string">'ADD'</span>,
      data: data.option
    });

    <span class="hljs-comment">// complete the observable</span>
    observer.complete();
  }, <span class="hljs-number">1500</span>);

  <span class="hljs-comment">// cancel timeout on unsubscribe</span>
  <span class="hljs-keyword">return</span> <span class="hljs-function"><span class="hljs-params">()</span> =&gt;</span> clearTimeout(timeout);
});</code></pre>
<h3 id="the-entire-concatmap-example" translation-result="on"><code>concatMap</code> 的完整例子</h3><h3 translation-origin="off">The entire <code>concatMap</code> example</h3>

<p translation-result="on">好，既然我们已经知道如何把 <code>setTimeout</code> 包装成一个 Observable 了，就接着看如何实现 <code>concatMap</code> 逻辑吧。</p><p translation-origin="off">Alright, now that we know how to wrap our <code>setTimeout</code> as an observable, let’s continue with the implementation of the <code>concatMap</code> logic.</p>

<pre><code class="language-typescript">concatMap(<span class="hljs-function"><span class="hljs-params">data</span> =&gt;</span> {
  <span class="hljs-keyword">const</span> id = data.option.value;

  <span class="hljs-keyword">if</span> (data.checkboxEvent.checked) {
    <span class="hljs-comment">// simulate async call</span>
    <span class="hljs-keyword">return</span> Observable.create(<span class="hljs-function">(<span class="hljs-params">observer</span>) =&gt;</span> {
      <span class="hljs-keyword">const</span> timeout = setTimeout(<span class="hljs-function"><span class="hljs-params">()</span> =&gt;</span> {
        <span class="hljs-built_in">console</span>.log(<span class="hljs-string">'Returning data'</span>);
        observer.next({
          <span class="hljs-keyword">type</span>: <span class="hljs-string">'ADD'</span>,
          data: data.option
        });
        observer.complete();
      }, <span class="hljs-number">1500</span>);

      <span class="hljs-keyword">return</span> <span class="hljs-function"><span class="hljs-params">()</span> =&gt;</span> clearTimeout(timeout);
    });
  } <span class="hljs-keyword">else</span> {
    <span class="hljs-keyword">return</span> of({
      <span class="hljs-keyword">type</span>: <span class="hljs-string">'REMOVE'</span>,
      data: id
    });
  }
})</code></pre>
<p translation-result="on">在 <code>selectionObject</code> 的 <code>.subscribe(...)</code> 中，我们会解析这个动作，并影响结果列表：</p><p translation-origin="off">In the <code>.subscribe(...)</code> of our <code>selectionObject</code> we then effectively parse the action and cause the side-effect on our result list:</p>

<pre><code class="language-typescript"> <span class="hljs-keyword">this</span>.selectionSubject
    .pipe(
      concatMap(<span class="hljs-keyword">data</span> =&gt; {
        ...
      })
    ).subscribe((action: any) =&gt; {
      <span class="hljs-keyword">if</span> (action.type === <span class="hljs-string">'ADD'</span>) {
        <span class="hljs-keyword">this</span>.records.push(action.<span class="hljs-keyword">data</span>)
      } <span class="hljs-keyword">else</span> {
        <span class="hljs-keyword">this</span>.records = <span class="hljs-keyword">this</span>.records.filter(x =&gt; x.value !== action.<span class="hljs-keyword">data</span>);
      }
    });</code></pre>
<p translation-result="on">太棒了！现在，每当用户单击复选框时，我们就不在其事件处理程序中实现这个逻辑，只要把它传给 <code>selectionSubject</code> 就可以了。</p><p translation-origin="off">Awesome! Now, whenever the user clicks a checkbox, in the according event handler, we don’t implement the logic, but rather we just need to pipe it into the <code>selectionSubject</code>.</p>

<pre><code class="language-typescript">onCheckListChange(<span class="hljs-keyword">data</span>: SelectionEvent) {
  <span class="hljs-keyword">this</span>.selectionSubject.next(<span class="hljs-keyword">data</span>);
}</code></pre>
<p translation-result="on">下面是 Stackblitz 上的例子。看！它对双击操作处理得完美！</p><p translation-result="on"><a href="https://stackblitz.com/edit/blog-guarantee-order-switchmap?ctl=1" target="_blank">在线例子</a></p><p translation-origin="off">Here’s the according Stackblitz example to play around with. Check it out, double-clicking works perfectly now!</p>


<h2 id="optimizing-with-switchmap" translation-result="on">用 <code>switchMap</code> 进行优化</h2><h2 translation-origin="off">Optimizing with <code>switchMap</code></h2>

<p translation-result="on">但还可以更进一步。在当前的 <code>concatMap</code> 例子中，当用户双击时，我们会等到异步调用返回后再删除它。那为什么还要先执行异步逻辑呢？当用户双击时，其实我们可以直接取消上一个操作，甚至都不用执行它，更节省时间。</p><p translation-origin="off">But can do even better. In the current <code>concatMap</code> example, when the user double-clicks, we effectively wait until the async call comes back and then remove it again. But why even execute the async logic. When the user double-clicks we can just abort the previous action and not even execute it, thus save time.</p>

<p translation-result="on">这就是 <code>switchMap</code> 所做的事。与 <code>concatMap</code> 不同，它不会等待上一个动作（也就是我们的 Observable 事件）执行完，而是会直接取消上一个 Observable。</p><p translation-origin="off">That’s what <code>switchMap</code> does. In contrast to <code>concatMap</code>, it doesn’t execute the actions (our Observable events) in sequence, but rather it cancels the previous Observable.</p>

<blockquote>
<p translation-result="on"><strong>小心!!</strong> 虽然在这个用例下<em>取消</em>是一种合理的选择，但可能并非所有情况下都是如此。所以在用 <code>concatMap</code> 或 <code>switchMap</code> 时一定要小心。</p><p translation-origin="off"><strong>Watch out!!</strong> While for this use-case <em>cancelling</em> was an option, this might not always be the case. So be careful to evaluate between using <code>concatMap</code> or <code>switchMap</code>.</p>

</blockquote>
<p translation-result="on">这是 Stackblitz 上的一个例子。要特别留意控制台日志。我们在 <code>setTimeout(..)</code> 中写了一个日志（<code>console.log('Returning data');</code>）。如果双击，该日志就不会出现，表示该异步操作甚至没有执行过。</p><p translation-result="on"><a href="https://stackblitz.com/edit/blog-guarantee-order-switchmap" target="_blank">在线例子</a>。</p><p translation-origin="off">Here’s a Stackblitz example. Pay particular attention to the console log. In the <code>setTimeout(..)</code> a log is written (<code>console.log('Returning data');</code>). If you double-click, that log doesn’t even appear, proving that the async action is not even executed.</p>


<h2 id="switchmap---potential-race-conditions" translation-result="on"><code>switchMap</code> - 潜在的竞态条件</h2><h2 translation-origin="off"><code>switchMap</code> - potential race conditions</h2>

<p translation-result="on">好，我们已经知道，可以用 <code>switchMap</code> 来优化 <code>concatMap</code> 方法，因为我们取消了前一个 Observable，以免当用户双击某个复选框的情况下执行该操作（其逻辑可能有开销）。但是，这里还有个问题： <strong>如果用户点击了第一个复选框之后快速点击第二个，该怎么办呢？</strong> 我们实际上会取消对第一个复选框的点击，这会阻止它被激活，这样显然是不对的。我们来看看如何解决这个问题。</p><p translation-origin="off">Ok, so we’ve learned, that with <code>switchMap</code> we can optimize our <code>concatMap</code> approach in that we cancel the previous observable, thus preventing from even executing that (possibly costly logic) in case when the user double-clicks on one of our checkboxes. But there’s a caveaut here: <strong>what if the user quickly clicks the 1st and then 2nd checkbox?</strong> We would actually cancel the click of the 1st checkbox, thus preventing it from being properly activated. Let’s see how to fix that.</p>

<p translation-result="on"><a href="https://mobile.twitter.com/KwintenP" target="_blank">Kwinten</a> 建议在这种情况下使用 <code>mergeMap</code>，然后使用 <code>takeUntil</code> 操作符来处理“取消”这种优化逻辑，使其验证第二个事件是否从同一个复选框进来的。下面是实现方式：</p><p translation-origin="off"><a href="https://mobile.twitter.com/KwintenP" target="_blank">Kwinten</a> suggested to use <code>mergeMap</code> in this case and then handling the “cancelling” optimization by using the <code>takeUntil</code> operator, verifying whether a second event from the same checkbox comes in. Here’s how to achieve that:</p>

<pre><code class="language-typescript"><span class="hljs-keyword">this</span>.selectionSubject
  .pipe(
    mergeMap(<span class="hljs-keyword">data</span> =&gt; {
      <span class="hljs-keyword">const</span> id = <span class="hljs-keyword">data</span>.option.value;

      <span class="hljs-keyword">if</span> (<span class="hljs-keyword">data</span>.checkboxEvent.checked) {
        <span class="hljs-keyword">return</span> Observable.create((observer) =&gt; {
          ...
        }).pipe(
          takeUntil(<span class="hljs-keyword">this</span>.selectionSubject.pipe(
            filter(<span class="hljs-keyword">data</span> =&gt; <span class="hljs-keyword">data</span>.option.value === id),
          ))
        );
      } <span class="hljs-keyword">else</span> {
        <span class="hljs-keyword">return</span> of({
          type: <span class="hljs-string">'REMOVE'</span>,
          <span class="hljs-keyword">data</span>: id
        });
      }
    }
    )
  ).subscribe((action: any) =&gt; {
    ...
  });</code></pre>
<p translation-result="on">如你所见，这个“异步”的 Observable 有一个 <code>takeUntil</code> 操作符，当 <code>selectionSubject</code> 上发生的新事件具有和我们曾处理的事件相同的 id 时，它就会停止那个 Observable。因为这种场景其实就是在双击同一个复选框。在所有其它情况下，我们只会完成这个 Observable，让它继续运行而不用终止它，这样就解决了快速点击多个不同复选框时的潜在问题😃。</p><p translation-origin="off">As you can see the “async” observable has a <code>takeUntil</code> that stops that Observable the moment a new event comes in on our <code>selectionSubject</code> with the same id we’re currently processing. Because that’s the scenario of a double-click on the same checkbox. In any other case, we just complete the observable and let it go on without terminating it, thus solving the potential issue of quickly clicking multiple different checkboxes 😃.</p>

<p translation-result="on">下面是修改后的 Stackblitz 版本。</p><p translation-result="on"><a href="https://stackblitz.com/edit/blog-guarantee-order-mergemap" target="_blank">在线例子</a>。</p><p translation-origin="off">And here’s the according modified Stackblitz to play around with.</p>


<h2 id="conclusion" translation-result="on">结论</h2><h2 translation-origin="off">Conclusion</h2>

<p translation-result="on">本文演示了 <code>concatMap</code> 和 <code>switchMap</code> 的一些实战用例。RxJS 非常强大，我们在这个例子中看到了如何以非常优雅和可维护的方式解决“操作顺序”的问题。</p><p translation-origin="off">This article demonstrates some pratical use cases for <code>concatMap</code> as well as <code>switchMap</code>. RxJS is powerful, and we see in this example how to solve the “ordering” problem in a very elegant and maintainable way.</p>

<p translation-result="on">不过，RxJS 也有它的学习曲线。我深信，学习它的最佳途径不是学习其运算符，而是学习实际的用例，以及如何用 RxJS 来解决这些用例。请继续关注今后的类似文章。</p><p translation-origin="off">RxJS has its learning curve, though. I highly believe the best way to learn it is not by learning its operators, but rather by real-world use cases and how to solve them with RxJS. Stay tuned for further articles like this one.</p>

<p translation-result="on"><em>（@各位 rxjs 专家：本文对你没啥用，抱歉😉）</em></p><p translation-origin="off"><em>(@rxjs experts: nothing for you here, I’m sorry 😉)</em></p>

</div></app-markdown-viewer></app-article-show></mat-sidenav-content><!----></mat-sidenav-container></app-layout-nav></app-article-layout></app-root>
<script src="/assets/js/translator.js" async=""></script>
<script type="text/javascript" src="runtime.9dbc0c306f01ba3805bf.js"></script><script type="text/javascript" src="polyfills.53c2af414a078f039587.js"></script><script type="text/javascript" src="main.6e3682316372a96655f1.js"></script>

</body></html>